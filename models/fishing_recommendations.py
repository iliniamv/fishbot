
# -*- coding: utf-8 -*-
from typing import Dict

class FishingRecommendations:
    """
    –§–æ—Ä–º–∏—Ä—É–µ—Ç –µ–¥–∏–Ω—ã–π –∫—Ä–∞—Å–∏–≤—ã–π –æ—Ç—á—ë—Ç –≤ —Å—Ç–∏–ª–µ:
    - –∫—Ä–∞—Ç–∫–∏–π –∏—Ç–æ–≥;
    - —Å–Ω–∞—Å—Ç–∏;
    - –ø—Ä–∏–∫–æ—Ä–º–∫–∞;
    - –Ω–∞—Å–∞–¥–∫–∏;
    - –ª—É—á—à–µ–µ –≤—Ä–µ–º—è (–¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ –ø–æ–¥—Å—Ç–∞–≤–ª—è–µ—Ç –æ–∫–Ω–∞ —Ä–∞—Å—Å–≤–µ—Ç/–∑–∞–∫–∞—Ç);
    - –≤–ª–∏—è–Ω–∏–µ –ø–æ–≥–æ–¥—ã (–∞–¥–∞–ø—Ç–∏–≤–Ω–æ –ø–æ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º).
    –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç –æ–¥–Ω—É –º–Ω–æ–≥–æ—Å—Ç—Ä–æ—á–Ω—É—é –°–¢–†–û–ö–£ (Markdown-—Å–æ–≤–º–µ—Å—Ç–∏–º—É—é).
    """

    def get_recommendations(self, fish_type: str, params: Dict, bite_windows: Dict, time_of_day: str) -> str:
        wt = float(params.get('water_temp', 16.0))
        air = float(params.get('air_temp', 18.0))
        press = float(params.get('pressure', 755.0))
        wind = float(params.get('wind_speed', 3.0))
        wind_dir = str(params.get('wind_dir', '–ø–µ—Ä–µ–º–µ–Ω–Ω—ã–π'))
        clouds = int(params.get('clouds', 50))

        # ------- –ö–†–ê–¢–ö–ò–ô –ò–¢–û–ì –ø–æ –≤–∏–¥—É -------
        fish = (fish_type or '').lower()
        if '–∫–∞—Ä–∞—Å—å' in fish:
            summary = '–∫–∞—Ä–∞—Å—å –∞–∫—Ç–∏–≤–µ–Ω —É—Ç—Ä–æ–º –∏ –≤–µ—á–µ—Ä–æ–º; –ª—É—á—à–µ —Ä–∞–±–æ—Ç–∞—é—Ç –æ–ø–∞—Ä—ã—à –∏ –ø–µ—Ä–ª–æ–≤–∫–∞. –î–µ—Ä–∂–∏—Å—å 1‚Äì2 –º —É —Ç—Ä–∞–≤—ã.'
        elif '–ª–µ—â' in fish:
            summary = '–ª–µ—â —Å—Ç–∞–±–∏–ª–µ–Ω –ø—Ä–∏ —É–º–µ—Ä–µ–Ω–Ω–æ–º –≤–µ—Ç—Ä–µ; –∏—â–∏ –±—Ä–æ–≤–∫–∏ 2.5‚Äì4 –º, —Ñ–∏–¥–µ—Ä –∏ —Ç–æ—á–Ω—ã–π –¥–æ–∫–æ—Ä–º.'
        elif '–æ–∫—É–Ω' in fish:
            summary = '–æ–∫—É–Ω—å –¥–µ—Ä–∂–∏—Ç—Å—è —Å—Ç–∞–π–∫–æ–π —É —Å–≤–∞–ª–æ–≤; –º–∏–∫—Ä–æ–¥–∂–∏–≥/–≤–µ—Ä—Ç—É—à–∫–∏ –º–∞–ª—ã–º–∏ —Ä–∞–∑–º–µ—Ä–∞–º–∏.'
        elif '—â—É–∫' in fish:
            summary = '—â—É–∫–∞ –≤ –æ–∫–Ω–∞—Ö —Ç—Ä–∞–≤—ã –∏ —É –≥—Ä–∞–Ω–∏—Ü—ã —á–∏—Å—Ç–æ–≥–æ; –º–∏–Ω–Ω–æ—É/—Ä–µ–∑–∏–Ω–∞ 3‚Äì5".'
        elif '—Å—É–¥–∞–∫' in fish:
            summary = '—Å—É–¥–∞–∫ –∂–¥—ë—Ç –Ω–∞ —Å–≤–∞–ª–∞—Ö –∏ —Ä—É—Å–ª–æ–≤—ã—Ö –±—Ä–æ–≤–∫–∞—Ö; –∫–ª–∞—Å—Å–∏—á–µ—Å–∫–∞—è —Å—Ç—É–ø–µ–Ω—å–∫–∞ –Ω–∞ —Å–∏–ª–∏–∫–æ–Ω.'
        else:
            summary = '–∏—â–∏ –∞–∫—Ç–∏–≤–Ω—É—é —Ä—ã–±—É —Å–º–µ–Ω–æ–π –≥–æ—Ä–∏–∑–æ–Ω—Ç–æ–≤, –º–µ—Å—Ç –∏ –ø–æ–¥–∞—á–∏.'

        # ------- –°–ù–ê–°–¢–ò -------
        if '–∫–∞—Ä–∞—Å—å' in fish:
            tackle = [
                '‚Ä¢ –ü–æ–ø–ª–∞–≤–æ—á–Ω–∞—è: 4‚Äì6 –º, –ª–µ—Å–∫–∞ 0.12‚Äì0.16, –∫—Ä—é—á–æ–∫ ‚Ññ14‚Äì16',
                '‚Ä¢ –§–∏–¥–µ—Ä: —Ç–µ—Å—Ç –¥–æ 40 –≥, –∫–æ—Ä–º—É—à–∫–∞ 20‚Äì30 –≥, –ø–æ–≤–æ–¥–æ–∫ 0.10‚Äì0.12'
            ]
        elif '–ª–µ—â' in fish:
            tackle = [
                '‚Ä¢ –§–∏–¥–µ—Ä: 40‚Äì80 –≥, –ø–æ–≤–æ–¥–æ–∫ 60‚Äì100 —Å–º',
                '‚Ä¢ –ö—Ä—é—á–æ–∫: ‚Ññ10‚Äì14, —á—É–≤—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–∞—è –≤–µ—Ä—à–∏–Ω–∫–∞'
            ]
        elif '–æ–∫—É–Ω' in fish:
            tackle = [
                '‚Ä¢ –°–ø–∏–Ω–Ω–∏–Ω–≥: —Ç–µ—Å—Ç –¥–æ ~10 –≥, —à–Ω—É—Ä #0.3‚Äì0.6',
                '‚Ä¢ –ú–∏–∫—Ä–æ–¥–∂–∏–≥/–≤–µ—Ä—Ç—É—à–∫–∏ ‚Ññ00‚Äì1'
            ]
        elif '—â—É–∫' in fish:
            tackle = [
                '‚Ä¢ –°–ø–∏–Ω–Ω–∏–Ω–≥: —Ç–µ—Å—Ç 10‚Äì30 –≥, —Ñ–ª—é–æ—Ä/—Å—Ç—Ä—É–Ω–∞ 20‚Äì30 —Å–º',
                '‚Ä¢ –ü—Ä–∏–º–∞–Ω–∫–∏: –º–∏–Ω–Ω–æ—É/—à—ç–¥ 70‚Äì110 –º–º, –∫–æ–ª–µ–±–∞–ª–∫–∏, —Ä–µ–∑–∏–Ω–∞ 3‚Äì5"'
            ]
        elif '—Å—É–¥–∞–∫' in fish:
            tackle = [
                '‚Ä¢ –°–ø–∏–Ω–Ω–∏–Ω–≥: –±—ã—Å—Ç—Ä—ã–π —Å—Ç—Ä–æ–π, –¥–∂–∏–≥-–≥–æ–ª–æ–≤—ã –ø–æ –≥–ª—É–±–∏–Ω–µ –∏ —Ç–µ—á–µ–Ω–∏—é',
                '‚Ä¢ –ü—Ä–∏–º–∞–Ω–∫–∏: –≤–∏–±—Ä–æ—Ö–≤–æ—Å—Ç—ã/—Ç–≤–∏—Å—Ç–µ—Ä—ã 3‚Äì5", –∫–æ–ª–µ–±–∞–ª–∫–∏'
            ]
        else:
            tackle = ['‚Ä¢ –£–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω–æ: –ø–æ–¥–±–∏—Ä–∞–π—Ç–µ —Å–Ω–∞—Å—Ç—å –ø–æ–¥ –≥–ª—É–±–∏–Ω—É/–≤–µ—Ç–µ—Ä, –Ω–µ –±–æ–π—Ç–µ—Å—å –º–µ–Ω—è—Ç—å –≤–µ—Å.']

        # ------- –ü–†–ò–ö–û–†–ú–ö–ê -------
        if '–∫–∞—Ä–∞—Å—å' in fish or '–ª–µ—â' in fish:
            groundbait = [
                '‚Ä¢ –°—É—Ö–∞—Ä–∏ 50%, —Å–µ–º–µ—á–∫–∏ 20%, –æ—Ç—Ä—É–±–∏ 15%, —Å—É—Ö–æ–µ –º–æ–ª–æ–∫–æ 10%, –∫–∞–∫–∞–æ 5%',
                '‚Ä¢ –ê—Ä–æ–º–∞—Ç—ã: –∫–∞—Ä–∞—Å—é ‚Äî —á–µ—Å–Ω–æ–∫/–≤–∞–Ω–∏–ª—å (–≤ –¥–æ–∂–¥—å ‚Äî –∫–æ–Ω–æ–ø–ª—è), –ª–µ—â—É ‚Äî –∫–æ—Ä–∏–∞–Ω–¥—Ä/–≤–∞–Ω–∏–ª—å',
                '‚Ä¢ –ñ–∏–≤–æ—Ç–Ω—ã–µ –¥–æ–±–∞–≤–∫–∏ –ø–æ —á—É—Ç—å-—á—É—Ç—å: —Ä—É–±–ª–µ–Ω—ã–π —á–µ—Ä–≤—å, –æ–ø–∞—Ä—ã—à'
            ]
        else:
            groundbait = ['‚Ä¢ –î–ª—è —Ö–∏—â–Ω–∏–∫–∞ –ø—Ä–∏–∫–æ—Ä–º–∫–∞ –Ω–µ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–∞; –≤–∞–∂–Ω–µ–µ –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π –≥–æ—Ä–∏–∑–æ–Ω—Ç –∏ —Å–∫–æ—Ä–æ—Å—Ç—å –ø—Ä–æ–≤–æ–¥–∫–∏.']

        # ------- –ù–ê–°–ê–î–ö–ò/–ü–†–ò–ú–ê–ù–ö–ò -------
        if '–∫–∞—Ä–∞—Å—å' in fish:
            baits = [
                '‚Ä¢ –ñ–∏–≤–æ—Ç–Ω—ã–µ: –æ–ø–∞—Ä—ã—à, —á–µ—Ä–≤—å, –º–æ—Ç—ã–ª—å',
                '‚Ä¢ –†–∞—Å—Ç–∏—Ç–µ–ª—å–Ω—ã–µ: –ø–µ—Ä–ª–æ–≤–∫–∞ (–º–æ–∂–Ω–æ —Å –º—ë–¥–æ–º), –∫—É–∫—É—Ä—É–∑–∞, –º–∞–Ω–∫–∞/—Ç–µ—Å—Ç–æ',
                '‚Ä¢ –ö–æ–º–±–æ: –º–æ—Ç—ã–ª—å+–æ–ø–∞—Ä—ã—à ("–±—É—Ç–µ—Ä–±—Ä–æ–¥")'
            ]
        elif '–ª–µ—â' in fish:
            baits = [
                '‚Ä¢ –û–ø–∞—Ä—ã—à, —á–µ—Ä–≤—å, –±—É—Ç–µ—Ä–±—Ä–æ–¥—ã; –≤ —Ç—ë–ø–ª–æ–π –≤–æ–¥–µ ‚Äî –ø–µ—Ä–ª–æ–≤–∫–∞/–≥–æ—Ä–æ—Ö',
            ]
        elif '–æ–∫—É–Ω' in fish:
            baits = [
                '‚Ä¢ –ú–∏–∫—Ä–æ–¥–∂–∏–≥ 2‚Äì4 —Å–º, –∞–∫—Ç–∏–≤–Ω—ã–µ —Å–∏–ª–∏–∫–æ–Ω—ã, –≤–µ—Ä—Ç—É—à–∫–∏ ‚Ññ00‚Äì1',
            ]
        elif '—â—É–∫' in fish:
            baits = [
                '‚Ä¢ –ú–∏–Ω–Ω–æ—É/—à—ç–¥ 70‚Äì110 –º–º, –∫–æ–ª–µ–±–∞–ª–∫–∏, —Ä–µ–∑–∏–Ω–∞ 3‚Äì5"',
            ]
        elif '—Å—É–¥–∞–∫' in fish:
            baits = [
                '‚Ä¢ –°–∏–ª–∏–∫–æ–Ω 3‚Äì5", –∫–ª–∞—Å—Å–∏—á–µ—Å–∫–∞—è —Å—Ç—É–ø–µ–Ω—å–∫–∞; –ø–∞—É–∑—ã –¥–ª–∏–Ω–Ω–µ–µ –≤ —Ö–æ–ª–æ–¥–Ω–æ–π –≤–æ–¥–µ',
            ]
        else:
            baits = ['‚Ä¢ –ü–æ–¥–±–∏—Ä–∞–π—Ç–µ –ø–æ–¥ –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å —Ä—ã–±—ã –∏ –ø—Ä–æ–∑—Ä–∞—á–Ω–æ—Å—Ç—å –≤–æ–¥—ã.']

        # ------- –í–†–ï–ú–Ø –°–£–¢–û–ö (–¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏) -------
        morning = bite_windows.get('morning', '‚Äî')
        evening = bite_windows.get('evening', '‚Äî')
        sunrise = bite_windows.get('sunrise', '‚Äî')
        sunset = bite_windows.get('sunset', '‚Äî')
        timing = [
            f'‚Ä¢ –£—Ç—Ä–æ: {morning}',
            f'‚Ä¢ –î–µ–Ω—å: –ø—Ä–∏ –ø–∞–¥–µ–Ω–∏–∏ –∫–ª—ë–≤–∞ ‚Äî –≥–ª—É–±–∂–µ/–¥–∞–ª—å—à–µ –∏ –¥–µ–ª–∏–∫–∞—Ç–Ω–µ–µ',
            f'‚Ä¢ –í–µ—á–µ—Ä: {evening}',
            f'‚Ä¢ –ê—Å—Ç—Ä–æ–Ω–æ–º–∏—è: –≤–æ—Å—Ö–æ–¥ {sunrise}, –∑–∞–∫–∞—Ç {sunset}'
        ]

        # ------- –í–õ–ò–Ø–ù–ò–ï –ü–û–ì–û–î–´ (–∞–¥–∞–ø—Ç–∏–≤–Ω–æ) -------
        weather_lines = []
        # –¢–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞ –≤–æ–¥—ã
        if wt < 10:
            weather_lines.append('‚Ä¢ –•–æ–ª–æ–¥–Ω–∞—è –≤–æ–¥–∞: –º–µ–¥–ª–µ–Ω–Ω–µ–µ –ø–æ–¥–∞—á–∞, –∂–∏–≤–æ—Ç–Ω—ã–µ –Ω–∞—Å–∞–¥–∫–∏ –≤ –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç–µ.')
        elif wt > 22:
            weather_lines.append('‚Ä¢ –¢—ë–ø–ª–∞—è –≤–æ–¥–∞: –ª–æ–≤–∏—Ç–µ —Ä–∞–Ω–Ω–∏–º —É—Ç—Ä–æ–º –∏ –≤–µ—á–µ—Ä–æ–º, —É–º–µ–Ω—å—à–∞–π—Ç–µ —Ä–∞–∑–º–µ—Ä –Ω–∞—Å–∞–¥–∫–∏/–ø—Ä–∏–º–∞–Ω–∫–∏.')
        else:
            weather_lines.append('‚Ä¢ –ö–æ–º—Ñ–æ—Ä—Ç–Ω–∞—è —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞ –≤–æ–¥—ã: –º–æ–∂–Ω–æ —ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç–∏—Ä–æ–≤–∞—Ç—å —Å –Ω–∞—Å–∞–¥–∫–∞–º–∏ –∏ –ø—Ä–æ–≤–æ–¥–∫–æ–π.')

        # –í–µ—Ç–µ—Ä
        if wind >= 8:
            weather_lines.append('‚Ä¢ –°–∏–ª—å–Ω—ã–π –≤–µ—Ç–µ—Ä: —É—Ç—è–∂–µ–ª—è–π—Ç–µ –æ—Å–Ω–∞—Å—Ç–∫—É, –∏—â–∏—Ç–µ –ø–æ–¥–≤–µ—Ç—Ä–µ–Ω–Ω—ã–µ –±—É—Ö—Ç—ã.')
        elif wind <= 1:
            weather_lines.append('‚Ä¢ –®—Ç–∏–ª—å: —Ç–æ–Ω–∫–∏–µ –ø–æ–≤–æ–¥–∫–∏ –∏ –º–∏–Ω–∏-–ø—Ä–∏–º–∞–Ω–∫–∏ –¥–∞—é—Ç –±–æ–ª—å—à–µ –ø–æ–∫–ª—ë–≤–æ–∫.')
        else:
            weather_lines.append(f'‚Ä¢ –í–µ—Ç–µ—Ä {wind:.1f} –º/—Å, {wind_dir}: –Ω–æ—Ä–º–∞–ª—å–Ω—ã–µ —É—Å–ª–æ–≤–∏—è, –ª—ë–≥–∫–∞—è —Ä—è–±—å —á–∞—Å—Ç–æ –ø–æ–º–æ–≥–∞–µ—Ç.')

        # –û–±–ª–∞—á–Ω–æ—Å—Ç—å
        if clouds < 20:
            weather_lines.append('‚Ä¢ –Ø—Å–Ω–æ: –µ—Å—Ç–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ —Ä–∞—Å—Ü–≤–µ—Ç–∫–∏ –∏ –∞–∫–∫—É—Ä–∞—Ç–Ω–∞—è –ø–æ–¥–∞—á–∞.')
        elif clouds > 80:
            weather_lines.append('‚Ä¢ –ü–∞—Å–º—É—Ä–Ω–æ: –º–æ–∂–Ω–æ —É–≤–µ–ª–∏—á–∏—Ç—å –∞—Ä–æ–º–∞—Ç/—Ä–∞–∑–º–µ—Ä –Ω–∞—Å–∞–¥–∫–∏.')
        else:
            weather_lines.append('‚Ä¢ –ü–µ—Ä–µ–º–µ–Ω–Ω–∞—è –æ–±–ª–∞—á–Ω–æ—Å—Ç—å: –¥–µ—Ä–∂–∏—Ç–µ –±–∞–ª–∞–Ω—Å ‚Äî –Ω–µ —Å–ª–∏—à–∫–æ–º —è—Ä–∫–æ –∏ –Ω–µ —Å–ª–∏—à–∫–æ–º –¥–µ–ª–∏–∫–∞—Ç–Ω–æ.')

        # –î–∞–≤–ª–µ–Ω–∏–µ
        if press < 740 or press > 770:
            weather_lines.append('‚Ä¢ –ù–µ—Å—Ç–∞–±–∏–ª—å–Ω–æ–µ –¥–∞–≤–ª–µ–Ω–∏–µ: –±–æ–ª—å—à–µ –ø–∞—É–∑, —á–∞—â–µ –º–µ–Ω—è–π—Ç–µ –Ω–∞—Å–∞–¥–∫—É.')

        # ------- –°–ë–û–†–ö–ê –û–¢–ß–Å–¢–ê -------
        parts = []
        parts.append(f'üéØ –ò—Ç–æ–≥: {summary}')
        parts.append('')
        parts.append('üé£ –°–Ω–∞—Å—Ç–∏:')
        parts += tackle
        parts.append('')
        parts.append('üçØ –ü—Ä–∏–∫–æ—Ä–º–∫–∞:')
        parts += groundbait
        parts.append('')
        parts.append('ü™± –ù–∞—Å–∞–¥–∫–∏ / –ø—Ä–∏–º–∞–Ω–∫–∏:')
        parts += baits
        parts.append('')
        parts.append('‚è∞ –í—Ä–µ–º—è:')
        parts += timing
        parts.append('')
        parts.append('üå¶Ô∏è –ü–æ–≥–æ–¥–∞:')
        parts += weather_lines

        return "\n".join(parts)
